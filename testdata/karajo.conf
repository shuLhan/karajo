## SPDX-FileCopyrightText: 2021 M. Shulhan <ms@kilabit.info>
## SPDX-License-Identifier: GPL-3.0-or-later

[karajo]
name = My karajo
listen_address = 127.0.0.1:31937
http_timeout = 5m0s
dir_base = testdata
dir_public = testdata
secret = s3cret

[karajo "job"]
name = Test fail
description = The job to test what the user interface and logs look likes \
 if its <b>fail</b>.
secret = s3cret
interval = 20s
max_requests = 2
http_method = POST
http_url = http://127.0.0.1:31937/karajo/hook/test-fail
http_request_type = json
http_header = A: B
http_header = C: D
http_insecure = false

[karajo "job"]
name = Test random
description = Test triggering hook /test-random
secret = s3cret
max_requests = 1
http_method = POST
http_url = /karajo/hook/test-random
http_request_type = json
http_insecure = false

[karajo "job"]
name = Test success
description = The job to test what the user interface and logs look likes \
 if its <i>success</i>.
secret = s3cret
interval = 20s
max_requests = 1
http_method = POST
http_url = /karajo/hook/test-success
http_request_type = json
http_header = X: Y
http_insecure = false

[hook "test fail"]
path = /test-fail
secret = s3cret
command = echo "Counter is $KARAJO_HOOK_COUNTER"
command = echo "Test hook fail"
command = command-not-found

[hook "test random"]
description = "Test running command with random exit status"
path = /test-random
secret = s3cret
command = echo "Counter is $KARAJO_HOOK_COUNTER"
command = rand=$(($RANDOM%2)) && echo $rand && exit $rand

[hook "test success"]
path = /test-success
secret = s3cret
command = echo "Counter is $KARAJO_HOOK_COUNTER"
command = echo "Test hook success"
